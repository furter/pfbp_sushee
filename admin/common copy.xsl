<?xml version="1.0" encoding="utf-8"?><xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">	<xsl:output method="xml" indent="yes" encoding="utf-8" doctype-public="-//W3C//DTD XHTML 1.0 Transitional//EN" doctype-system="http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd" omit-xml-declaration="yes"/>	<!-- -->	<!-- paramètres utiles partout -->	<xsl:param name="majuscules">ABCDEFGHIJKLMNOPQRSTUVWXYZÀÁÂÃÄÅÆÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖØÙÚÛÜÝÞ</xsl:param>	<xsl:param name="minuscules">abcdefghijklmnopqrstuvwxyzàáâãäåæçèéêëìíîïðñòóôõöøùúûüýþ</xsl:param>	<xsl:param name="sans_accent">abcdefghijklmnopqrstuvwxyzaaaaaaæceeeeiiiidnoooooouuuuyp</xsl:param>	<xsl:param name="apos">		<xsl:text>'</xsl:text>	</xsl:param>	<xsl:param name="new_apos">		<xsl:text>’</xsl:text>	</xsl:param>	<xsl:param name="public">http://pfb.officity.com/admin/</xsl:param>	<xsl:param name="files" select="/RESPONSE/NECTIL/files_url"/>	<xsl:param name="months" select="/RESPONSE/MONTHS"/>	<xsl:param name="website" select="/RESPONSE/RESULTS[@name='website']/MEDIA"/>	<xsl:param name="media" select="/RESPONSE/RESULTS[@name='media']/MEDIA"/>	<xsl:param name="data" select="/RESPONSE/RESULTS[@name='data']/MEDIA"/>	<xsl:param name="ID" select="/RESPONSE/URL/ID"/>	<!-- -->	<!-- entête html -->	<xsl:template name="attribute_html">		<xsl:attribute name="lang">			<xsl:value-of select="//RESULTS/LANGUAGE[@ID = //NECTIL/language]/ISO1"/>		</xsl:attribute>	</xsl:template>	<xsl:template name="html_head">		<meta name="description" content="{$website/DESCRIPTIONS/DESCRIPTION/CUSTOM/METADESCRIPTION}"/>		<meta name="keywords">			<xsl:attribute name="content">				<xsl:apply-templates select="$website" mode="title"/>				<xsl:if test="$website/@ID != $media/@ID">					<xsl:text> &gt; </xsl:text>					<xsl:apply-templates select="$media" mode="title"/>				</xsl:if>				<xsl:text> - </xsl:text>				<xsl:for-each select="$website/DESCRIPTIONS/DESCRIPTION/CUSTOM/METAKEYWORD">					<xsl:value-of select="."/>					<xsl:if test="position() != last()">						<xsl:text> - </xsl:text>					</xsl:if>				</xsl:for-each>			</xsl:attribute>		</meta>		<meta name="date" content="{/RESPONSE/URL/today}"/>		<meta name="content-language" content="{/RESPONSE/NECTIL/language}"/>		<meta name="language" content="{/RESPONSE/NECTIL/language}"/>		<meta name="dateofLastModification" content="{$media/INFO/MODIFICATIONDATE}"/>		<meta name="robots" content="index,follow"/>		<meta name="googlebot" content="index,follow"/>		<meta name="content-type" content="text/html"/>		<title>			<xsl:apply-templates select="$website" mode="title"/>			<xsl:if test="$media and $website/@ID != $media/@ID">				<xsl:text> - </xsl:text>				<xsl:apply-templates select="$media" mode="title"/>			</xsl:if>		</title>		<link rel="stylesheet" type="text/css" href="styles.css"/>		<script type="text/javascript" src="{$public}script.js"> </script>		<script type="text/javascript" src="{//NECTIL/kernel_url}Library/js/jquery/jquery.min.js"> </script>		<link rel="icon" href="" type="image/x-icon"/>	</xsl:template>	<!-- -->	<!-- ajout d'attribut au body -->	<xsl:template match="MEDIA" mode="attribute">		<xsl:attribute name="class">			<xsl:value-of select="INFO/MEDIATYPE"/>		</xsl:attribute>	</xsl:template>	<xsl:template match="MEDIA[INFO/PAGETOCALL != '']" mode="attribute">		<xsl:attribute name="class">			<xsl:value-of select="substring-before(INFO/PAGETOCALL, '.php')"/>		</xsl:attribute>	</xsl:template>	<!-- -->	<!-- titres -->	<xsl:template match="MEDIA" mode="title">		<xsl:value-of select="DESCRIPTIONS/DESCRIPTION/TITLE"/>	</xsl:template>	<!-- -->	<!-- contacts -->	<xsl:template match="CONTACT" mode="country">		<xsl:value-of select="/RESPONSE/RESULTS/COUNTRY[@ID = current()/INFO/COUNTRYID]/LABEL"/>	</xsl:template>	<xsl:template match="MEDIA" mode="author">		<xsl:apply-templates select="DEPENDENCIES/DEPENDENCY[@type='Author']/CONTACT[1]" mode="author"/>	</xsl:template>	<xsl:template match="CONTACT" mode="author">		<xsl:value-of select="INFO/DENOMINATION"/>	</xsl:template>	<xsl:template match="CONTACT[INFO/DENOMINATION = '']" mode="author">		<xsl:value-of select="INFO/FIRSTNAME"/>		<xsl:text> </xsl:text>		<xsl:value-of select="INFO/LASTNAME"/>	</xsl:template>	<!-- -->	<!-- liens -->	<xsl:template match="MEDIA" mode="href">		<xsl:attribute name="href">			<xsl:value-of select="INFO/MEDIATYPE"/>			<xsl:text>.php?ID=</xsl:text>			<xsl:value-of select="@ID"/>		</xsl:attribute>	</xsl:template>	<xsl:template match="MEDIA[INFO/MEDIATYPE = 'Link']" mode="href">		<xsl:attribute name="href">			<xsl:value-of select="DESCRIPTIONS/DESCRIPTION/URL"/>		</xsl:attribute>	</xsl:template>	<xsl:template match="MEDIA[INFO/PAGETOCALL != '']" mode="href">		<xsl:attribute name="href">			<xsl:value-of select="INFO/PAGETOCALL"/>			<xsl:text>?ID=</xsl:text>			<xsl:value-of select="@ID"/>		</xsl:attribute>		<xsl:attribute name="title">			<xsl:apply-templates select="." mode="title"/>		</xsl:attribute>	</xsl:template>	<xsl:template match="MEDIA" mode="active"/>	<xsl:template match="MEDIA[@ID=//URL/ID]" mode="active">		<xsl:attribute name="class">active</xsl:attribute>	</xsl:template>	<xsl:template match="MEDIA" mode="link">		<a>			<xsl:apply-templates select="." mode="href"/>			<xsl:apply-templates select="." mode="active"/>			<xsl:apply-templates select="." mode="title"/>		</a>	</xsl:template>	<xsl:template match="MEDIA[INFO/MEDIATYPE = 'Link']" mode="link">		<a href="{DESCRIPTIONS/DESCRIPTION/URL}">			<xsl:apply-templates select="." mode="title"/>		</a>	</xsl:template>	<!-- -->	<!-- navigation -->	<xsl:template match="MEDIA[INFO/MEDIATYPE = 'Website']" mode="navigation_item">		<li>			<a>				<xsl:apply-templates select="." mode="href"/>				<xsl:apply-templates select="." mode="active"/>				<xsl:value-of select="//LABEL[@name='website_home']"/>			</a>		</li>	</xsl:template>	<xsl:template match="MEDIA" mode="navigation_item">		<li>			<xsl:apply-templates select="." mode="link"/>		</li>	</xsl:template>	<xsl:template match="MEDIA[INFO/MEDIATYPE='Website']" mode="navigation">		<div id="navigation">			<ul class="highlight col_9 gouttiere">				<xsl:apply-templates select="DEPENDENCIES/DEPENDENCY[@type='mediaNavigation']/MEDIA[position() &lt;= 3]" mode="navigation_highlight"/>			</ul>			<ul class="normal col_4">				<xsl:apply-templates select="DEPENDENCIES/DEPENDENCY[@type='mediaNavigation']/MEDIA[position() &gt; 3]" mode="navigation_item"/>				<!-- check -->				<!--li>More ?</li-->			</ul>			<br class="break"/>		</div>	</xsl:template>	<xsl:template name="navigation">		<xsl:apply-templates select="$website" mode="navigation"/>	</xsl:template>	<!-- -->	<!-- config details - form -->	<xsl:template match="MORE" mode="config">		<div id="{@name}" class="hidden">			<xsl:apply-templates select="*" mode="config"/>		</div>		<div id="{@name}_button">			<a class="discreet_button" href="javascript:">				<xsl:attribute name="onclick">					<xsl:text>$('#</xsl:text>					<xsl:value-of select="@name"/>					<xsl:text>').toggleClass('hidden');</xsl:text>					<xsl:text>if($('#</xsl:text>					<xsl:value-of select="@name"/>					<xsl:text>').hasClass('hidden').toString() == 'true') {$(this).text('</xsl:text>					<xsl:value-of select="//LABEL[@name='d_browse_more_criterias']"/>					<xsl:text>');} else {$(this).text('</xsl:text>					<xsl:value-of select="//LABEL[@name='d_browse_less_criterias']"/>					<xsl:text>');}</xsl:text>				</xsl:attribute>				<xsl:value-of select="//LABEL[@name='d_browse_more_criterias']"/>			</a>		</div>	</xsl:template>	<xsl:template name="form_select_country">		<xsl:param name="name"/>		<xsl:param name="selected_value"/>		<xsl:param name="first_option_label" select="//LABEL[@name='f_select_first_option_label']"/>		<xsl:param name="select_label" select="//LABEL[@name = 'country']"/>		<xsl:call-template name="form_select">			<xsl:with-param name="name" select="$name"/>			<xsl:with-param name="selected_value" select="$selected_value"/>			<xsl:with-param name="first_option_label" select="$first_option_label"/>			<xsl:with-param name="select_label" select="$select_label"/>			<xsl:with-param name="options_node" select="/RESPONSE/RESULTS/COUNTRY"/>		</xsl:call-template>	</xsl:template>	<xsl:template match="SELECT[@type='COUNTRY']" mode="config">		<xsl:call-template name="form_select">			<xsl:with-param name="name" select="@path"/>			<xsl:with-param name="selected_value" select="//URL/*[name() = current()/@path]"/>			<xsl:with-param name="first_option_label" select="//LABEL[@name='f_select_first_option_label']"/>			<xsl:with-param name="select_label">				<xsl:value-of select="//LABEL[@name = 'country']"/>			</xsl:with-param>			<xsl:with-param name="options_node" select="//RESULTS/*[name() = current()/@type]"/>		</xsl:call-template>	</xsl:template>	<xsl:template match="SELECT[@type='LIST']" mode="config">		<xsl:call-template name="form_select">			<xsl:with-param name="name" select="@path"/>			<xsl:with-param name="selected_value" select="//URL/*[name() = current()/@path]"/>			<xsl:with-param name="first_option_label" select="//LABEL[@name='f_select_first_option_label']"/>			<xsl:with-param name="select_label">				<xsl:value-of select="//LABEL[@name = current()/@path]"/>			</xsl:with-param>			<xsl:with-param name="options_node" select="//RESULTS/LIST[@name = current()/@path]"/>		</xsl:call-template>	</xsl:template>	<xsl:template match="SELECT[@type='CATEGORY']" mode="config">		<xsl:variable name="category" select="//RESULTS//CATEGORY[UNIQUENAME = current()/@path]"/>		<xsl:call-template name="form_select">			<xsl:with-param name="first_option_label" select="//LABEL[@name='f_select_first_option_label']"/>			<xsl:with-param name="name" select="@path"/>			<xsl:with-param name="selected_value" select="//URL/*[name() = current()/@path]"/>			<xsl:with-param name="select_label">				<xsl:value-of select="$category/LABEL"/>			</xsl:with-param>			<xsl:with-param name="options_node" select="$category/CATEGORY"/>		</xsl:call-template>	</xsl:template>	<xsl:template match="SELECT[@type='MEDIA']" mode="config">		<xsl:call-template name="form_select">			<xsl:with-param name="name" select="@path"/>			<xsl:with-param name="selected_value" select="//URL/*[name() = current()/@path]"/>			<xsl:with-param name="first_option_label" select="//LABEL[@name='f_select_first_option_label']"/>			<xsl:with-param name="select_label">				<xsl:value-of select="//LABEL[@name = current()/@path]"/>			</xsl:with-param>			<xsl:with-param name="options_node" select="//RESULTS[@name = current()/@path]/MEDIA"/>		</xsl:call-template>	</xsl:template>	<xsl:template match="DATA" mode="config">		<xsl:variable name="value">			<xsl:apply-templates select="." mode="value"/>		</xsl:variable>		<xsl:if test="$value != ''">			<p>				<strong>					<xsl:apply-templates select="." mode="label"/>					<xsl:text>: </xsl:text>				</strong>				<xsl:value-of select="$value"/>			</p>		</xsl:if>	</xsl:template>	<xsl:template match="*[@type='CATEGORY']" mode="label">		<xsl:value-of select="/RESPONSE/RESULTS//CATEGORY[UNIQUENAME = current()/@path]/LABEL"/>	</xsl:template>	<xsl:template match="*[@type='MEDIA']" mode="label">		<xsl:value-of select="//LABEL[@name = current()/@path]"/>	</xsl:template>	<xsl:template match="*[@type='COUNTRY']" mode="label">		<xsl:value-of select="//LABEL[@name='country']"/>	</xsl:template>	<xsl:template match="*[@type='LIST']" mode="label">		<xsl:value-of select="//LABEL[@name=current()/@path]"/>	</xsl:template>	<xsl:template match="GROUP" mode="label">		<xsl:value-of select="@class"/>	</xsl:template>	<xsl:template match="DATA[@type='CATEGORY']" mode="value">		<xsl:variable name="path" select="current()/@path"/>		<xsl:for-each select="//CATEGORIES/CATEGORY[FATHERNAME = $path]">			<a href="">				<xsl:value-of select="LABEL"/>			</a>			<xsl:call-template name="add_coma_if_not_last"/>		</xsl:for-each>	</xsl:template>	<xsl:template match="DATA[@type='DESCRIPTION'] | DATAS" mode="label">		<xsl:variable name="label" select="current()/@label"/>		<xsl:value-of select="/RESPONSE/RESULTS/LABEL[@name=$label]"/>	</xsl:template>	<xsl:template match="DATA[@type='DESCRIPTION']" mode="value">		<xsl:value-of select="DESCRIPTIONS/DESCRIPTION//*[name() = current()/@node]"/>	</xsl:template>	<!-- -->	<!-- form and specific stuffs -->	<xsl:template match="MEDIA[INFO/PAGETOCALL = 'SearchContacts.php']" mode="specific">		<form name="Form{substring-before(INFO/PAGETOCALL, '.php')}" action="{INFO/PAGETOCALL}" method="get">			<input type="hidden" name="ID" value="{@ID}"/>			<input type="hidden" name="sort" value="{//URL/sort}"/>			<input type="hidden" name="browse" value="1"/>			<xsl:call-template name="form_input_text">				<xsl:with-param name="name">search</xsl:with-param>				<xsl:with-param name="value">					<xsl:choose>						<xsl:when test="not(//URL/search) or //URL/search = ''">							<xsl:value-of select="//LABEL[@name='d_search_fill_dancer_name']"/>						</xsl:when>						<xsl:otherwise>							<xsl:value-of select="//URL/search"/>						</xsl:otherwise>					</xsl:choose>				</xsl:with-param>				<xsl:with-param name="class">					<xsl:text>texte</xsl:text>					<xsl:if test="not(//URL/search) or //URL/search = ''">						<xsl:text> no_value</xsl:text>					</xsl:if>				</xsl:with-param>				<xsl:with-param name="onfocus">					<xsl:if test="not(//URL/search) or //URL/search = ''">						<xsl:text>clear_field_content('search');</xsl:text>					</xsl:if>				</xsl:with-param>				<xsl:with-param name="onblur">					<xsl:text>no_value_field_content("search", "</xsl:text>					<xsl:value-of select="//LABEL[@name='d_search_fill_dancer_name']"/>					<xsl:text>");</xsl:text>				</xsl:with-param>			</xsl:call-template>			<xsl:apply-templates select="." mode="button"/>		</form>	</xsl:template>	<xsl:template match="MEDIA[INFO/PAGETOCALL = 'BrowseContacts.php']" mode="specific">		<form name="Form{substring-before(INFO/PAGETOCALL, '.php')}" action="{INFO/PAGETOCALL}" method="get">			<input type="hidden" name="ID" value="{@ID}"/>			<input type="hidden" name="sort" value="{//URL/sort}"/>			<input type="hidden" name="browse" value="1"/>			<xsl:apply-templates select="/RESPONSE/CONFIG/FORM[@name='BrowseContacts']/*" mode="config"/>			<xsl:apply-templates select="." mode="button"/>			<br class="break"/>		</form>		<br class="break"/>	</xsl:template>	<xsl:template match="FORM" mode="config">		<li id="{@name}_container" class="tool_nav">			<a href="#" onclick="tool_nav_toggle_display('{@name}');">Recherche</a>			<form name="{@name}" id="{@name}" action="{//NECTIL/this_script}" method="get" class="hidden tool">				<input type="hidden" name="ID" value="{//URL/ID}"/>				<input type="hidden" name="sort" value="{//URL/sort}"/>				<input type="hidden" name="{@name}" value="1"/>				<xsl:apply-templates select="*" mode="config"/>				<xsl:apply-templates select="." mode="button"/>			</form>		</li>	</xsl:template>	<!-- -->	<!-- tools navigation -->	<xsl:template match="FORM" mode="tools_nav">		<xsl:apply-templates select="." mode="config"/>	</xsl:template>	<xsl:template match="DISPLAY" mode="tools_nav">		<xsl:apply-templates select="." mode="display_options"/>	</xsl:template>	<!-- -->	<!-- boutons des formulaires -->	<xsl:template match="FORM[@name = 'BrowseContacts']" mode="button">		<div class="input_button_container">			<input type="submit" class="button" value="Rechercher"/>		</div>	</xsl:template>	<xsl:template match="MEDIA[INFO/PAGETOCALL = 'SearchContacts.php']" mode="button">		<div class="input_button_container">			<input type="submit" class="button" value="Chercher"/>		</div>	</xsl:template>	<xsl:template match="MEDIA | ITEM" mode="button">		<div class="input_button_container">			<input type="submit" class="button" value="send"/>		</div>	</xsl:template>	<!-- -->	<!-- médias in content -->	<xsl:template match="MEDIA" mode="in_content">		<div>			<xsl:apply-templates select="." mode="attribute"/>			<xsl:apply-templates select="." mode="h2"/>			<xsl:apply-templates select="." mode="specific"/>		</div>	</xsl:template>	<!-- -->	<!-- textes -->	<xsl:template match="MEDIA" mode="h1">		<h1>			<xsl:apply-templates select="." mode="title"/>		</h1>	</xsl:template>	<xsl:template match="MEDIA" mode="h2">		<h2>			<xsl:apply-templates select="." mode="title"/>		</h2>	</xsl:template>	<xsl:template match="MEDIA" mode="body">		<xsl:apply-templates select="DESCRIPTIONS/DESCRIPTION/BODY/CSS" mode="css"/>	</xsl:template>	<xsl:template match="MEDIA" mode="header">		<xsl:apply-templates select="DESCRIPTIONS/DESCRIPTION/HEADER/CSS" mode="css">			<xsl:with-param name="class">header</xsl:with-param>		</xsl:apply-templates>	</xsl:template>	<xsl:template match="CSS" mode="css">		<div class="styled_text">			<xsl:apply-templates select="*"/>		</div>	</xsl:template>	<!-- -->	<!-- texte stylé -->	<xsl:template match="CSS//*">		<xsl:choose>			<xsl:when test="name(.)='nectil_url' and not(@pagetocall)">				<a href="{@mediatype}.php?ID={@ID}" class="{@class}">					<xsl:value-of select="."/>				</a>			</xsl:when>			<xsl:when test="name(.)='nectil_url' and @pagetocall">				<a href="{@pagetocall}?ID={@ID}" class="{@class}">					<xsl:value-of select="."/>				</a>			</xsl:when>			<xsl:otherwise>				<xsl:element name="{local-name()}">					<xsl:copy-of select="./@*"/>					<xsl:apply-templates/>				</xsl:element>			</xsl:otherwise>		</xsl:choose>	</xsl:template>	<!-- images -->	<!-- -->	<xsl:template match="MEDIA" mode="visual">		<xsl:param name="width">200</xsl:param>		<xsl:variable name="visual" select="DESCRIPTIONS/DESCRIPTION/CUSTOM/Visual"/>		<xsl:if test="$visual != ''">			<img>				<xsl:attribute name="src">					<xsl:value-of select="$public"/>					<xsl:text>img_resize.php?path=</xsl:text>					<xsl:value-of select="$visual"/>					<xsl:text>&amp;width=</xsl:text>					<xsl:value-of select="$width"/>				</xsl:attribute>				<xsl:attribute name="alt">					<xsl:apply-templates select="." mode="title"/>				</xsl:attribute>			</img>		</xsl:if>	</xsl:template>	<xsl:template match="CSS//img[@class='image']">		<xsl:element name="{local-name()}">			<xsl:copy-of select="@*"/>			<xsl:apply-templates select="@style"/>			<xsl:choose>				<xsl:when test="@height != ''">					<xsl:apply-templates select="@src">						<xsl:with-param name="height" select="@height"/>					</xsl:apply-templates>				</xsl:when>				<xsl:otherwise>					<xsl:apply-templates select="@src">						<xsl:with-param name="width" select="@width"/>					</xsl:apply-templates>				</xsl:otherwise>			</xsl:choose>			<xsl:apply-templates select="@width"/>			<xsl:apply-templates select="@height"/>			<xsl:apply-templates/>		</xsl:element>	</xsl:template>	<xsl:template match="CSS//img[@class='image']/@src">		<xsl:param name="width" select="284"/>		<xsl:param name="height" select="284"/>		<xsl:attribute name="src">			<xsl:text>img_resize.php?path=</xsl:text>			<xsl:value-of select="substring-after(.,//NECTIL/files_url)"/>			<xsl:text>&amp;</xsl:text>			<xsl:choose>				<xsl:when test="$height != ''">					<xsl:text>height=</xsl:text>				</xsl:when>				<xsl:otherwise>					<xsl:text>width=</xsl:text>				</xsl:otherwise>			</xsl:choose>			<xsl:value-of select="substring-before($width, 'px')"/>		</xsl:attribute>	</xsl:template>	<xsl:template match="CSS//img[@class='image']/@style">		<xsl:attribute name="style">			<xsl:choose>				<xsl:when test=". = 'float:left;'">					<xsl:value-of select="."/>					<xsl:text> margin:6px 20px 6px 0;</xsl:text>				</xsl:when>				<xsl:when test=". = 'float:right;'">					<xsl:value-of select="."/>					<xsl:text> margin:6px 0 6px 20px;</xsl:text>				</xsl:when>				<xsl:otherwise>					<xsl:value-of select="."/>				</xsl:otherwise>			</xsl:choose>		</xsl:attribute>	</xsl:template>	<xsl:template match="CSS//img[@class='image']/@width"/>	<xsl:template match="CSS//img[@class='image']/@height"/>	<!-- -->	<!-- date -->	<xsl:template name="day">		<xsl:param name="date"/>		<xsl:choose>			<xsl:when test="substring($date,9,1) = 0">				<xsl:value-of select="substring($date,10,1)"/>			</xsl:when>			<xsl:otherwise>				<xsl:value-of select="substring($date,9,2)"/>			</xsl:otherwise>		</xsl:choose>	</xsl:template>	<xsl:template name="date_hour">		<xsl:param name="date"/>		<xsl:call-template name="date">			<xsl:with-param name="date" select="$date"/>		</xsl:call-template>		<xsl:text> </xsl:text>		<xsl:value-of select="//LABEL[@name='between_date_and_hour']"/>		<xsl:text> </xsl:text>		<xsl:value-of select="substring($date, 12, 5)"/>	</xsl:template>	<xsl:template name="date">		<xsl:param name="date"/>		<xsl:call-template name="day">			<xsl:with-param name="date">				<xsl:value-of select="$date"/>			</xsl:with-param>		</xsl:call-template>		<xsl:text>/</xsl:text>		<xsl:value-of select="substring($date,6,2)"/>		<xsl:text>/</xsl:text>		<xsl:value-of select="substring($date,1,4)"/>	</xsl:template>	<xsl:template name="dates">		<xsl:param name="start" select="INFO/EVENTSTART"/>		<xsl:param name="end" select="INFO/EVENTEND"/>		<xsl:choose>			<xsl:when test="substring($end,1,4) = 0000">				<xsl:call-template name="date">					<xsl:with-param name="date">						<xsl:value-of select="$start"/>					</xsl:with-param>				</xsl:call-template>			</xsl:when>			<xsl:when test="substring($start,1,4) != substring($end,1,4)">				<xsl:call-template name="date_hour">					<xsl:with-param name="date">						<xsl:value-of select="$start"/>					</xsl:with-param>				</xsl:call-template>				<xsl:text> - </xsl:text>				<xsl:call-template name="date_hour">					<xsl:with-param name="date">						<xsl:value-of select="$end"/>					</xsl:with-param>				</xsl:call-template>			</xsl:when>			<xsl:when test="substring($start,6,2) != substring($end,6,2)">				<xsl:call-template name="day">					<xsl:with-param name="date">						<xsl:value-of select="$start"/>					</xsl:with-param>				</xsl:call-template>				<xsl:text> </xsl:text>				<xsl:value-of select="translate(/RESPONSE/RESULTS/MONTH[@ID = substring($start,6,2)]/LABEL, $majuscules,$minuscules)"/>				<xsl:text> - </xsl:text>				<xsl:call-template name="day">					<xsl:with-param name="date">						<xsl:value-of select="$end"/>					</xsl:with-param>				</xsl:call-template>				<xsl:text> </xsl:text>				<xsl:value-of select="translate(/RESPONSE/RESULTS/MONTH[@ID = substring($start,6,2)]/LABEL, $majuscules,$minuscules)"/>				<xsl:text> </xsl:text>				<xsl:value-of select="substring($start,1,4)"/>			</xsl:when>			<xsl:when test="substring($start,9,2) != substring($end,9,2)">				<xsl:call-template name="day">					<xsl:with-param name="date">						<xsl:value-of select="$start"/>					</xsl:with-param>				</xsl:call-template>				<xsl:choose>					<xsl:when test="substring($start,9,2) = substring($end,9,2) - 1">						<xsl:text> + </xsl:text>					</xsl:when>					<xsl:otherwise>						<xsl:text> → </xsl:text>					</xsl:otherwise>				</xsl:choose>				<xsl:call-template name="day">					<xsl:with-param name="date">						<xsl:value-of select="$end"/>					</xsl:with-param>				</xsl:call-template>				<xsl:text>-</xsl:text>				<xsl:value-of select="substring($start,6,2)"/>				<!--xsl:value-of	select="translate(/RESPONSE/RESULTS/MONTH[@ID = substring($start,6,2)]/LABEL, $majuscules,$minuscules)"/-->				<xsl:text>-</xsl:text>				<xsl:value-of select="substring($start,1,4)"/>			</xsl:when>			<xsl:otherwise>				<xsl:call-template name="date_hour">					<xsl:with-param name="date">						<xsl:value-of select="$start"/>					</xsl:with-param>				</xsl:call-template>			</xsl:otherwise>		</xsl:choose>	</xsl:template>	<!-- -->	<!-- éléments de formulaire -->	<xsl:template name="form_captcha">		<xsl:param name="label" select="//LABEL[@name='f_captcha']"/>		<xsl:param name="name">visitor-guess</xsl:param>		<xsl:param name="mandatory" select="1"/>		<xsl:param name="more_info"/>		<div class="captcha_container">			<label for="{$name}">				<xsl:value-of select="$label"/>				<xsl:call-template name="check_mandatory">					<xsl:with-param name="mandatory" select="$mandatory"/>				</xsl:call-template>			</label>			<div class="img_captcha">				<!--img src="captcha.php" alt="{$label}" class="captcha"/-->				<img src="{//NECTIL/files_url}{/RESPONSE/RESULTS/CAPTCHA}" alt="{$label}" class="captcha"/>			</div>			<input type="text" id="{$name}" name="{$name}" class="texte"/>			<xsl:if test="$more_info != ''">				<dfn>					<xsl:value-of select="$more_info"/>				</dfn>			</xsl:if>			<br class="break"/>		</div>	</xsl:template>	<xsl:template name="form_input_text">		<xsl:param name="label"/>		<xsl:param name="value"/>		<xsl:param name="class">texte</xsl:param>		<xsl:param name="type">text</xsl:param>		<xsl:param name="name"/>		<xsl:param name="onfocus"/>		<xsl:param name="onblur"/>		<xsl:param name="maxchars"/>		<xsl:param name="mandatory"/>		<xsl:param name="more_info"/>		<div class="input_text_container">			<label for="{$name}">				<xsl:value-of select="$label"/>				<xsl:call-template name="check_mandatory">					<xsl:with-param name="mandatory" select="$mandatory"/>				</xsl:call-template>			</label>			<input type="{$type}" id="{$name}" name="{$name}" value="{$value}" maxlength="{$maxchars}">				<xsl:if test="$onblur != ''">					<xsl:attribute name="onblur">						<xsl:value-of select="$onblur"/>					</xsl:attribute>				</xsl:if>				<xsl:if test="$onfocus != ''">					<xsl:attribute name="onfocus">						<xsl:value-of select="$onfocus"/>					</xsl:attribute>				</xsl:if>				<xsl:attribute name="class">					<xsl:value-of select="$class"/>					<xsl:if test="$mandatory = 1">						<xsl:text> mandatory</xsl:text>					</xsl:if>				</xsl:attribute>			</input>			<xsl:if test="$more_info != ''">				<dfn>					<xsl:value-of select="$more_info"/>				</dfn>			</xsl:if>			<br class="break"/>		</div>	</xsl:template>	<xsl:template name="form_textarea">		<xsl:param name="label"/>		<xsl:param name="onclick"/>		<xsl:param name="onfocus"/>		<xsl:param name="value"/>		<xsl:param name="class">texte</xsl:param>		<xsl:param name="name"/>		<xsl:param name="maxchars"/>		<xsl:param name="mandatory"/>		<div class="textarea_container">			<xsl:if test="$label != ''">				<label for="{$name}">					<xsl:value-of select="$label"/>					<xsl:call-template name="check_mandatory">						<xsl:with-param name="mandatory" select="$mandatory"/>					</xsl:call-template>				</label>			</xsl:if>			<!--br/-->			<textarea id="{$name}" name="{$name}" rows="" cols="">				<xsl:if test="$onclick != ''">					<xsl:attribute name="onclick">						<xsl:value-of select="$onclick"/>					</xsl:attribute>				</xsl:if>				<xsl:if test="$maxchars != ''">					<xsl:attribute name="maxlength">						<xsl:value-of select="$maxchars"/>					</xsl:attribute>				</xsl:if>				<xsl:if test="$onfocus != ''">					<xsl:attribute name="onfocus">						<xsl:value-of select="$onfocus"/>					</xsl:attribute>				</xsl:if>				<xsl:attribute name="class">					<xsl:value-of select="$class"/>					<xsl:if test="$mandatory = 1">						<xsl:text> mandatory</xsl:text>					</xsl:if>				</xsl:attribute>				<xsl:value-of select="$value"/>			</textarea>			<!--br class="break"/-->		</div>	</xsl:template>	<xsl:template name="form_select_option">		<xsl:param name="selected_value"/>		<xsl:param name="label"/>		<xsl:param name="value"/>		<option value="{$value}">			<xsl:if test="$value = $selected_value">				<xsl:attribute name="selected"/>			</xsl:if>			<xsl:value-of select="$label"/>		</option>	</xsl:template>	<xsl:template match="LABEL" mode="select_option">		<xsl:param name="selected_value"/>		<xsl:call-template name="form_select_option">			<xsl:with-param name="selected_value" select="$selected_value"/>			<xsl:with-param name="label" select="."/>			<xsl:with-param name="value" select="."/>		</xsl:call-template>	</xsl:template>	<xsl:template match="COUNTRY" mode="select_option">		<xsl:param name="selected_value"/>		<xsl:call-template name="form_select_option">			<xsl:with-param name="selected_value" select="$selected_value"/>			<xsl:with-param name="label" select="LABEL"/>			<xsl:with-param name="value" select="@ID"/>		</xsl:call-template>	</xsl:template>	<xsl:template match="CATEGORY" mode="select_option">		<xsl:param name="selected_value"/>		<xsl:call-template name="form_select_option">			<xsl:with-param name="selected_value" select="$selected_value"/>			<xsl:with-param name="label" select="LABEL"/>			<xsl:with-param name="value" select="@ID"/>		</xsl:call-template>	</xsl:template>	<xsl:template match="ITEM" mode="select_option">		<xsl:param name="selected_value"/>		<xsl:call-template name="form_select_option">			<xsl:with-param name="selected_value" select="$selected_value"/>			<xsl:with-param name="label" select="@label"/>			<xsl:with-param name="value" select="@value"/>		</xsl:call-template>	</xsl:template>	<xsl:template match="MEDIA[INFO/MEDIATYPE='Music']" mode="select_option">		<xsl:param name="selected_value"/>		<xsl:variable name="label">			<xsl:value-of select="DESCRIPTIONS/DESCRIPTION/SIGNATURE"/>			<xsl:text> </xsl:text>			<xsl:value-of select="//LABEL[@name='d_music_by']"/>			<xsl:text> </xsl:text>			<xsl:value-of select="DEPENDENCIES/DEPENDENCY[@type='SpectacleToBio']/MEDIA/DESCRIPTIONS/DESCRIPTION/TITLE"/>		</xsl:variable>		<xsl:call-template name="form_select_option">			<xsl:with-param name="selected_value" select="$selected_value"/>			<xsl:with-param name="label" select="$label"/>			<xsl:with-param name="value" select="@ID"/>		</xsl:call-template>	</xsl:template>	<xsl:template match="E" mode="select_option">		<xsl:param name="selected_value"/>		<xsl:param name="from" select="0"/>		<xsl:variable name="result">			<xsl:choose>				<xsl:when test="substring(. - $from, 1, 1) = '-' ">					<xsl:value-of select="substring(. - $from,2)"/>				</xsl:when>				<xsl:otherwise>					<xsl:value-of select=". - $from"/>				</xsl:otherwise>			</xsl:choose>		</xsl:variable>		<xsl:call-template name="form_select_option">			<xsl:with-param name="selected_value" select="$selected_value"/>			<xsl:with-param name="label" select="$result"/>			<xsl:with-param name="value" select="$result"/>		</xsl:call-template>	</xsl:template>	<xsl:template name="form_select">		<xsl:param name="name"/>		<xsl:param name="mandatory"/>		<xsl:param name="select_label"/>		<xsl:param name="first_option_label"/>		<xsl:param name="first_option_value"/>		<xsl:param name="options_node"/>		<xsl:param name="selected_value"/>		<xsl:param name="from"/>		<div class="select_container">			<label for="{$name}">				<!--span class="position">					<xsl:value-of select="position()"/>					<xsl:text>. </xsl:text>				</span-->				<xsl:value-of select="$select_label"/>				<xsl:call-template name="check_mandatory">					<xsl:with-param name="mandatory" select="$mandatory"/>				</xsl:call-template>			</label>			<!--br/-->			<select name="{$name}" id="{$name}">				<xsl:if test="$mandatory = 1">					<xsl:attribute name="class">mandatory</xsl:attribute>				</xsl:if>				<xsl:if test="$first_option_label != ''">					<option value="{$first_option_value}">						<xsl:value-of select="$first_option_label"/>					</option>				</xsl:if>				<xsl:apply-templates select="$options_node" mode="select_option">					<xsl:with-param name="selected_value" select="$selected_value"/>					<xsl:with-param name="from" select="$from"/>				</xsl:apply-templates>			</select>			<br class="break"/>		</div>	</xsl:template>	<xsl:template name="form_radio">		<xsl:param name="label"/>		<xsl:param name="value"/>		<xsl:param name="aID"/>		<xsl:param name="name"/>		<xsl:param name="mandatory"/>		<input type="radio" id="{$aID}" name="{$name}" value="{$value}"/>		<label for="{$aID}">			<xsl:value-of select="$label"/>			<xsl:call-template name="check_mandatory"/>		</label>	</xsl:template>	<xsl:template name="form_select_locations">		<xsl:param name="selected_value"/>		<xsl:param name="name"/>		<xsl:call-template name="form_select">			<xsl:with-param name="name" select="$name"/>			<xsl:with-param name="mandatory" select="1"/>			<xsl:with-param name="select_label" select="//LABEL[@name='city']"/>			<xsl:with-param name="first_option_label" select="//LABEL[@name='select_answer']"/>			<xsl:with-param name="first_option_value">null</xsl:with-param>			<xsl:with-param name="options_node" select="/RESPONSE/RESULTS[@name='localites']/LIST/ITEM"/>			<xsl:with-param name="selected_value" select="$selected_value"/>		</xsl:call-template>	</xsl:template>	<xsl:template name="form_select_numbers">		<xsl:param name="start" select="0"/>		<xsl:param name="from" select="0"/>		<xsl:param name="end" select="20"/>		<xsl:param name="name"/>		<xsl:param name="mandatory"/>		<xsl:param name="select_label"/>		<xsl:param name="first_option_label"/>		<xsl:param name="first_option_value"/>		<xsl:param name="options_node" select="/RESPONSE/RESULTS/ENUM/E[. &gt;= $start and . &lt;= $end]"/>		<xsl:param name="selected_value"/>		<xsl:call-template name="form_select">			<xsl:with-param name="name" select="$name"/>			<xsl:with-param name="mandatory" select="$mandatory"/>			<xsl:with-param name="select_label" select="$select_label"/>			<xsl:with-param name="first_option_label" select="$first_option_label"/>			<xsl:with-param name="first_option_value" select="$first_option_value"/>			<xsl:with-param name="options_node" select="$options_node"/>			<xsl:with-param name="selected_value" select="$selected_value"/>			<xsl:with-param name="from" select="$from"/>		</xsl:call-template>	</xsl:template>	<xsl:template name="check_mandatory">		<xsl:param name="mandatory"/>		<xsl:if test="$mandatory = 1">			<small class="mandatory" title="{//LABEL[@name='mandatory']}">*</small>		</xsl:if>	</xsl:template>	<xsl:template name="check_mandatory_class">		<xsl:param name="mandatory"/>		<xsl:if test="$mandatory = 1">			<xsl:attribute name="class">mandatory</xsl:attribute>		</xsl:if>	</xsl:template>	<!-- -->	<!-- search details -->	<xsl:template match="URL" mode="search_details">		<xsl:param name="module">			<xsl:for-each select="/RESPONSE/RESULTS[@name='data']/*[1]">				<xsl:value-of select="name()"/>			</xsl:for-each>		</xsl:param>		<xsl:variable name="elements_found" select="concat('module_', $module, '_found')"/>		<xsl:variable name="hits" select="/RESPONSE/RESULTS[@name='data']/@hits"/>		<div class="browser_tools col_8" id="search_details">			<ul>				<li class="title">					<xsl:value-of select="//LABEL[@name='f_search_criterias']"/>				</li>				<xsl:if test="//URL/search != ''">					<li>						<xsl:value-of select="//URL/search"/>					</li>				</xsl:if>				<xsl:for-each select="*">					<xsl:variable name="var_name" select="name()"/>					<xsl:variable name="var_value" select="."/>					<xsl:for-each select="/RESPONSE/CONFIG/FORM[@name = 'BrowseContacts']//*[@path = $var_name]">						<xsl:if test="$var_value != ''">							<li>								<xsl:apply-templates select="." mode="label"/>								<xsl:text>: </xsl:text>								<xsl:choose>									<xsl:when test="@type='CATEGORY'">										<xsl:value-of select="(//CATEGORY[@ID = $var_value]/LABEL) [1]"/>									</xsl:when>									<xsl:when test="@type='MEDIA'">										<xsl:value-of select="(//MEDIA[@ID = $var_value]/DESCRIPTIONS/DESCRIPTION/SIGNATURE) [1]"/>										<xsl:text> </xsl:text>										<xsl:value-of select="//LABEL[@name='d_music_by']"/>										<xsl:text> </xsl:text>										<xsl:value-of select="(//MEDIA[@ID = $var_value]/DEPENDENCIES/DEPENDENCY[@type='SpectacleToBio']/MEDIA/DESCRIPTIONS/DESCRIPTION/TITLE) [1]"/>									</xsl:when>									<xsl:when test="@type='LIST'">										<xsl:value-of select="(//LIST/ITEM[@value = $var_value]/@label) [1]"/>									</xsl:when>									<xsl:when test="@type='COUNTRY'">										<xsl:value-of select="(//COUNTRY[@ID = $var_value]/LABEL) [1]"/>									</xsl:when>									<xsl:when test="@type='ENUM' and @path= 'BIRTHDAY'">										<xsl:value-of select="substring(//URL/now, 1, 4) - substring($var_value,12,4)"/>										<xsl:choose>											<xsl:when test="substring(//URL/now, 1, 4) - substring($var_value,12,4) &gt;= 66">												<xsl:text>+ </xsl:text>												<xsl:value-of select="//LABEL[@name='d_years']"/>											</xsl:when>											<xsl:otherwise>												<xsl:text> - </xsl:text>												<xsl:value-of select="substring(//URL/now, 1, 4) - substring($var_value,1,4)"/>												<xsl:text> </xsl:text>												<xsl:value-of select="//LABEL[@name='d_years']"/>											</xsl:otherwise>										</xsl:choose>									</xsl:when>									<xsl:otherwise>																			</xsl:otherwise>								</xsl:choose>							</li>						</xsl:if>					</xsl:for-each>				</xsl:for-each>			</ul>			<ul>				<li class="title">					<xsl:value-of select="$hits"/>					<xsl:text> </xsl:text>					<xsl:value-of select="//LABEL[@name=$elements_found]"/>				</li>				<li>					<a href="#" onclick="generate_contact_CSV();">						<xsl:value-of select="//LABEL[@name='download_listing']"/>					</a>								</li>			</ul>					</div>	</xsl:template>	<!-- -->	<!-- pagination -->	<xsl:template match="RESULTS" mode="pagination">		<xsl:if test="@pages &gt; 1">			<xsl:variable name="base_link">				<xsl:value-of select="//NECTIL/this_script"/>				<xsl:text>?</xsl:text>				<xsl:for-each select="//URL/*[name() != 'now' and name() != 'language' and name() != 'page']">					<xsl:value-of select="name()"/>					<xsl:text>=</xsl:text>					<xsl:value-of select="."/>					<xsl:text>&amp;</xsl:text>				</xsl:for-each>			</xsl:variable>			<div class="browser_tools col_8">				<ul>					<li class="title">						<xsl:value-of select="//LABEL[@name='pages']"/>					</li>					<xsl:if test="@page &gt; 1">						<li>							<a href="{$base_link}page={@page - 1}">								<xsl:text>Previous</xsl:text>							</a>						</li>					</xsl:if>					<xsl:for-each select="/RESPONSE/RESULTS/ENUM/E[. &lt;= current()/@pages]">						<li>							<a href="{$base_link}page={.}">								<xsl:if test=". = //URL/page">									<xsl:attribute name="class">active</xsl:attribute>								</xsl:if>								<xsl:value-of select="."/>							</a>						</li>					</xsl:for-each>					<xsl:if test="@page != @pages">						<li>							<a href="{$base_link}page={@page + 1}">								<xsl:text>Next</xsl:text>							</a>						</li>					</xsl:if>				</ul>			</div>		</xsl:if>	</xsl:template>	<!-- -->	<!-- construction du header -->	<!-- -->	<!-- table header -->	<xsl:template match="GROUP" mode="display_header">		<xsl:apply-templates select="*" mode="display_header"/>	</xsl:template>	<xsl:template match="UPDATE" mode="display_header">		<th> - </th>	</xsl:template>	<xsl:template match="DATA" mode="display_header">		<xsl:param name="target">			<xsl:choose>				<xsl:when test="@service = 'DEPENDENCY'">					<xsl:value-of select="@type"/>				</xsl:when>				<xsl:otherwise>					<xsl:value-of select="@path"/>				</xsl:otherwise>			</xsl:choose>		</xsl:param>		<xsl:param name="class" select="concat(../@class, ' ', $target)"/>		<th>			<xsl:if test="$class != ''">				<xsl:attribute name="class">					<xsl:value-of select="$class"/>				</xsl:attribute>			</xsl:if>			<xsl:apply-templates select="." mode="sort"/>			<br/>			<br/>			<xsl:apply-templates select="." mode="label"/>		</th>	</xsl:template>	<!-- -->	<!-- specific element label -->	<xsl:template match="DATA" mode="label">		<xsl:value-of select="@path"/>	</xsl:template>	<xsl:template match="DATA[@service='INFO']" mode="label">		<xsl:param name="label" select="concat('f_', @path)"/>		<xsl:choose>			<xsl:when test="//LABEL[@name=$label]">				<xsl:value-of select="//LABEL[@name=$label]"/>			</xsl:when>			<xsl:otherwise>				<xsl:value-of select="@path"/>			</xsl:otherwise>		</xsl:choose>	</xsl:template>	<xsl:template match="DATA[@service='CATEGORY']" mode="label">		<xsl:value-of select="/RESPONSE/RESULTS//CATEGORY[UNIQUENAME = current()/@path]/LABEL"/>	</xsl:template>	<xsl:template match="DATA[@service='DEPENDENCY']" mode="label">		<xsl:param name="type" select="@type"/>		<xsl:param name="label" select="//DEPENDENCYTYPE[TYPE = $type]/DENOMINATION/LABEL[@languageID = //NECTIL/language]"/>		<xsl:choose>			<xsl:when test="$label != ''">				<xsl:value-of select="$label"/>			</xsl:when>			<xsl:otherwise>				<xsl:value-of select="$type"/>			</xsl:otherwise>		</xsl:choose>	</xsl:template>	<!-- -->	<!-- specific elements sort template -->	<xsl:template match="*" mode="basic_sort">		<xsl:param name="var"/>		<xsl:param name="type" select="@data-type"/>		<a href="{//NECTIL/this_script}?sort={$var}&amp;order=descending&amp;type={$type}">			<img src="images/down.gif"/>		</a>		<a href="{//NECTIL/this_script}?sort={$var}&amp;order=ascending&amp;type={$type}">			<img src="images/up.gif"/>		</a>	</xsl:template>	<xsl:template match="DATA" mode="sort">		<xsl:apply-templates select="." mode="basic_sort">			<xsl:with-param name="var">				<xsl:value-of select="@node"/>			</xsl:with-param>		</xsl:apply-templates>	</xsl:template>	<xsl:template match="DATA[@service='DEPENDENCY']" mode="sort">		<xsl:apply-templates select="." mode="basic_sort">			<xsl:with-param name="var">DEPENDENCY[<xsl:value-of select="@type"/>]</xsl:with-param>		</xsl:apply-templates>	</xsl:template>	<xsl:template match="DATA[@service='CATEGORY']" mode="sort">		<xsl:apply-templates select="." mode="basic_sort">			<xsl:with-param name="var">CATEGORY[<xsl:value-of select="@fatherID"/>]</xsl:with-param>		</xsl:apply-templates>	</xsl:template>	<!-- -->	<!-- critères de tri -->	<xsl:template match="LIST" mode="sort_criterias">		<xsl:variable name="base_link">			<xsl:value-of select="//NECTIL/this_script"/>			<xsl:text>?</xsl:text>			<xsl:for-each select="//URL/*[name() != 'now' and name() != 'language' and name() != 'page' and name() != 'sort']">				<xsl:value-of select="name()"/>				<xsl:text>=</xsl:text>				<xsl:value-of select="."/>				<xsl:text>&amp;</xsl:text>			</xsl:for-each>		</xsl:variable>		<div class="browser_tools col_8">			<ul>				<li class="title">					<xsl:value-of select="//LABEL[@name='browse_dancers_sort_on']"/>				</li>				<xsl:for-each select="ITEM[@value != 'music']">					<li>						<a href="{$base_link}sort={@value}">							<xsl:if test="@value = //URL/sort">								<xsl:attribute name="class">active</xsl:attribute>							</xsl:if>							<xsl:value-of select="@label"/>						</a>					</li>				</xsl:for-each>			</ul>		</div>	</xsl:template>	<!-- -->	<!-- listing -->	<xsl:template match="MEDIA" mode="data">		<tr id="m{@ID}">			<xsl:apply-templates select="DESCRIPTIONS/DESCRIPTION/CUSTOM/NUMBER" mode="td"/>			<xsl:apply-templates select="DESCRIPTIONS/DESCRIPTION/TITLE" mode="td"/>			<xsl:apply-templates select="DESCRIPTIONS/DESCRIPTION/CUSTOM/YEAR" mode="td"/>			<xsl:apply-templates select="CATEGORIES/CATEGORY[@fatherID = '6']" mode="td"/>			<xsl:apply-templates select="CATEGORIES" mode="td">				<xsl:with-param name="fatherID" select="21"/>			</xsl:apply-templates>			<xsl:apply-templates select="DEPENDENCIES/DEPENDENCY[@type='BookToEditor']" mode="td"/>			<xsl:apply-templates select="DEPENDENCIES/DEPENDENCY[@type='BookToGraphist']" mode="td"/>			<xsl:apply-templates select="DEPENDENCIES/DEPENDENCY[@type='BookToBinder']" mode="td"/>			<xsl:apply-templates select="DEPENDENCIES/DEPENDENCY[@type='BookToPrinter']" mode="td"/>			<xsl:apply-templates select="DEPENDENCIES/DEPENDENCY[@type='BookToPeopleContact']" mode="td"/>		</tr>	</xsl:template>	<xsl:template match="CONTACT" mode="data">		<tr id="c{@ID}">			<xsl:apply-templates select="." mode="td_tools"/>			<xsl:apply-templates select="INFO/LASTNAME" mode="td"/>			<xsl:apply-templates select="INFO/FIRSTNAME" mode="td"/>			<xsl:apply-templates select="INFO/DENOMINATION" mode="td"/>			<xsl:apply-templates select="CATEGORIES" mode="td">				<xsl:with-param name="uniquename" select="'professionel'"/>			</xsl:apply-templates>			<xsl:apply-templates select="INFO/EMAIL1" mode="td"/>			<xsl:apply-templates select="INFO/MOBILEPHONE" mode="td"/>			<xsl:apply-templates select="INFO/PHONE1" mode="td"/>			<xsl:apply-templates select="INFO/ADDRESS" mode="td"/>			<xsl:apply-templates select="INFO/POSTALCODE" mode="td"/>			<xsl:apply-templates select="INFO/CITY" mode="td"/>			<xsl:apply-templates select="INFO/COUNTRYID" mode="td"/>			<xsl:apply-templates select="DEPENDENCIES/DEPENDENCY[@type='EditorToBook']" mode="td"/>			<xsl:apply-templates select="DEPENDENCIES/DEPENDENCY[@type='GraphistToBook']" mode="td"/>			<xsl:apply-templates select="DEPENDENCIES/DEPENDENCY[@type='PhotographToBook']" mode="td"/>			<xsl:apply-templates select="DEPENDENCIES/DEPENDENCY[@type='IllustratorToBook']" mode="td"/>			<xsl:apply-templates select="DEPENDENCIES/DEPENDENCY[@type='BinderToBook']" mode="td"/>			<xsl:apply-templates select="DEPENDENCIES/DEPENDENCY[@type='PrinterToBook']" mode="td"/>		</tr>	</xsl:template>	<!-- -->	<!-- construction du listing -->	<xsl:template name="add_class">		<xsl:param name="class"/>		<xsl:if test="$class != ''">			<xsl:attribute name="class">				<xsl:value-of select="$class"/>			</xsl:attribute>		</xsl:if>	</xsl:template>	<xsl:template match="CONTACT" mode="td_tools">		<td>			<a href="#" onclick="display_contact('{@ID}');">				<xsl:value-of select="//LABEL[@name='update']"/>			</a>		</td>	</xsl:template>	<xsl:template match="*" mode="td">		<xsl:param name="name" select="name()"/>		<xsl:param name="class" select="/RESPONSE/DISPLAY/GROUP[DATA/@path = $name]/@class"/>		<td>			<xsl:call-template name="add_class">				<xsl:with-param name="class" select="concat($class,' ',$name)"/>			</xsl:call-template>			<xsl:apply-templates select="." mode="td_content"/>		</td>	</xsl:template>	<xsl:template match="CATEGORIES" mode="td">		<xsl:param name="uniquename"/>		<xsl:param name="name" select="$uniquename"/>		<xsl:param name="class" select="/RESPONSE/DISPLAY/GROUP[DATA/@path = $name]/@class"/>		<td>			<xsl:call-template name="add_class">				<xsl:with-param name="class" select="concat($class,' ',$name)"/>			</xsl:call-template>			<xsl:for-each select="CATEGORY[FATHERNAME = $uniquename]">				<xsl:value-of select="LABEL"/>				<xsl:call-template name="add_coma_if_not_last"/>			</xsl:for-each>		</td>	</xsl:template>	<xsl:template match="DEPENDENCY" mode="td">		<xsl:param name="name" select="@type"/>		<xsl:param name="class" select="/RESPONSE/DISPLAY/GROUP[DATA/@type = $name]/@class"/>		<td>			<xsl:call-template name="add_class">				<xsl:with-param name="class" select="concat($class,' ',$name)"/>			</xsl:call-template>			<xsl:call-template name="display_dependency">				<xsl:with-param name="dependency" select="@type"/>			</xsl:call-template>		</td>	</xsl:template>	<xsl:template match="*" mode="td_content">		<xsl:value-of select="."/>	</xsl:template>	<xsl:template match="CATEGORY" mode="td_content">		<xsl:value-of select="LABEL"/>	</xsl:template>	<xsl:template match="CATEGORY[UNIQUENAME ='refus']" mode="td_content">		<strong>REFUS: </strong>		<xsl:value-of select="DESCRIPTIONS/DESCRIPTION/CUSTOM/REFUS"/>	</xsl:template>	<xsl:template name="display_dependency">		<xsl:param name="dependency"/>		<xsl:for-each select="*">			<xsl:apply-templates select="." mode="title"/>			<xsl:call-template name="add_coma_if_not_last"/>		</xsl:for-each>	</xsl:template>	<!-- -->	<!-- display options -->	<xsl:template match="DISPLAY" mode="display_options">		<li id="display_options_container" class="tool_nav">			<a href="#" onclick="tool_nav_toggle_display('display_options');">Options d'affichage</a>			<form name="display_options" id="display_options" class="hidden tool">				<ul>					<xsl:apply-templates select="*" mode="display_options"/>				</ul>			</form>		</li>	</xsl:template>	<xsl:template match="DATA | GROUP" mode="display_options">		<xsl:param name="target">			<xsl:choose>				<xsl:when test="name() = 'GROUP'">					<xsl:value-of select="@class"/>				</xsl:when>				<xsl:when test="@service = 'DEPENDENCY'">					<xsl:value-of select="@type"/>				</xsl:when>				<xsl:otherwise>					<xsl:value-of select="@path"/>				</xsl:otherwise>			</xsl:choose>		</xsl:param>		<xsl:variable name="cbID" select="concat('d_o_', $target)"/>		<li id="cont_{$cbID}">			<input type="checkbox" name="{$cbID}" id="{$cbID}" checked="checked" onclick="toggle_display('{$target}');"/>			<label for="{$cbID}">				<xsl:apply-templates select="." mode="label"/>			</label>			<xsl:if test="name() = 'GROUP'">				<ul id="{$cbID}_subcontent">					<xsl:apply-templates select="*" mode="display_options"/>				</ul>			</xsl:if>		</li>	</xsl:template>	<!-- -->	<!-- -->	<xsl:template match="MEDIA" mode="more">		<p class="more">			<a>				<xsl:apply-templates select="." mode="href"/>				<xsl:value-of select="//LABEL[@name='read_more']"/>			</a>		</p>	</xsl:template>	<!-- -->	<!-- contenu -->	<xsl:template match="MEDIA" mode="content">		<div id="main">			<xsl:apply-templates select="." mode="h1"/>			<xsl:apply-templates select="." mode="body"/>			<hr class="clear"/>		</div>	</xsl:template>	<!-- -->	<!-- side navigation / content -->	<xsl:template match="MEDIA" mode="side_content">		<div id="side">			<xsl:apply-templates select="DEPENDENCIES/DEPENDENCY[@type='mediaSideContent']/MEDIA[@ID != //URL/ID]" mode="in_content"/>		</div>	</xsl:template>	<!-- -->	<!-- bottom content -->	<xsl:template match="MEDIA" mode="top">		<div id="top">			<div id="navigation" class="col_6 gouttiere">				<xsl:apply-templates select="." mode="title"/>				<ul>					<xsl:apply-templates select="DEPENDENCIES/DEPENDENCY[@type='mediaNavigation']/MEDIA" mode="navigation_item"/>				</ul>			</div>			<br class="break"/>		</div>	</xsl:template>	<!-- -->	<!-- accords -->	<xsl:template name="check_pluriel">		<xsl:param name="zero"/>		<xsl:param name="un"/>		<xsl:param name="plusieurs"/>		<xsl:param name="value"/>		<xsl:choose>			<xsl:when test="$value = 0">				<xsl:value-of select="$zero"/>			</xsl:when>			<xsl:otherwise>				<xsl:value-of select="$value"/>				<xsl:text> </xsl:text>				<xsl:choose>					<xsl:when test="$value = 1">						<xsl:value-of select="$un"/>					</xsl:when>					<xsl:otherwise>						<xsl:value-of select="$plusieurs"/>					</xsl:otherwise>				</xsl:choose>			</xsl:otherwise>		</xsl:choose>	</xsl:template>	<!-- -->	<!--fonction de titrage-->	<xsl:template name="add_br_if_not_last">		<xsl:if test="position()!=last()">			<br/>		</xsl:if>	</xsl:template>	<xsl:template name="add_coma_if_not_last">		<xsl:if test="position()!=last()">			<xsl:text>, </xsl:text>		</xsl:if>	</xsl:template>	<xsl:template name="add_space_if_not_last">		<xsl:if test="position()!=last()">			<xsl:text> </xsl:text>		</xsl:if>	</xsl:template>	<!-- -->	<!-- -->	<xsl:template name="titrage">		<xsl:param name="text"/>		<xsl:param name="color"/>		<xsl:param name="size"/>		<xsl:param name="first">true</xsl:param>		<xsl:variable name="real_text">			<xsl:value-of select="translate($text,$apos,$new_apos)"/>		</xsl:variable>		<img alt="" src="titrage.php?title={$real_text}&amp;color={$color}&amp;size={$size}">			<xsl:if test="$first='true'">				<xsl:attribute name="alt">					<xsl:value-of select="$text"/>				</xsl:attribute>			</xsl:if>		</img>	</xsl:template>	<!-- -->	<!-- lightbox -->	<xsl:template name="lightbox">		<xsl:param name="content"/>		<div id="lightbox" class="hidden">			<div id="lightbox_container">							</div>		</div>	</xsl:template></xsl:stylesheet>