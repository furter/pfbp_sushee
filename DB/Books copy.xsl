<?xml version="1.0"?><xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">	<xsl:template match="/RESPONSE">		<xsl:param name="data" select="/RESPONSE/RESULTS[@name='data']/MEDIA"/>		<xsl:param name="sort"><xsl:value-of select="//URL/sort"/></xsl:param>		<xsl:param name="order"><xsl:value-of select="//URL/order"/></xsl:param>		<html>			<head>				<title>Prix Fernand Baudin - Liste des soumissions</title>				<style>					body{ font-family:Helvetica, Arial, Sans-Serif;}					table, tr, td, th {border:1px solid black; border-collapse:collapse; vertical-align:top; padding:2px;font-size:11px;}					a img{border:none;}				</style>			</head>			<body>				<h1>Prix Fernand Baudin - Liste des soumissions</h1>				<table>					<tr>						<th>							<xsl:call-template name="sort">								<xsl:with-param name="var">DESCRIPTIONS/DESCRIPTION/CUSTOM/NUMBER</xsl:with-param>							</xsl:call-template>							<xsl:text>Num&#xE9;ro</xsl:text>						</th>						<th>							<xsl:call-template name="sort">								<xsl:with-param name="var">DESCRIPTIONS/DESCRIPTION/TITLE</xsl:with-param>							</xsl:call-template>							<xsl:text>Titre</xsl:text>						</th>						<th>							<xsl:call-template name="sort">								<xsl:with-param name="var">DESCRIPTIONS/DESCRIPTION/CUSTOM/YEAR</xsl:with-param>							</xsl:call-template>							<xsl:text>Ann&#xE9;e</xsl:text>						</th>						<th>							<xsl:call-template name="sort">								<xsl:with-param name="var">CATEGORIES/CATEGORY[@fatherID=6]</xsl:with-param>							</xsl:call-template>							<xsl:text>Cat&#xE9;gorie</xsl:text>						</th>						<th>							<xsl:call-template name="sort">								<xsl:with-param name="var">CATEGORIES/CATEGORY[@fatherID=21]</xsl:with-param>							</xsl:call-template>							<xsl:text>Prix</xsl:text>						</th>						<th>							<xsl:call-template name="sort">								<xsl:with-param name="var">DEPENDENCIES/DEPENDENCY[@type='BookToEditor']/CONTACT</xsl:with-param>							</xsl:call-template>							<xsl:text>Editeur</xsl:text>						</th>						<th>							<xsl:call-template name="sort">								<xsl:with-param name="var">DEPENDENCIES/DEPENDENCY[@type='BookToGraphist']/CONTACT</xsl:with-param>							</xsl:call-template>							<xsl:text>Graphiste</xsl:text>						</th>						<th>							<xsl:call-template name="sort">								<xsl:with-param name="var">DEPENDENCIES/DEPENDENCY[@type='BookToBinder']/CONTACT</xsl:with-param>							</xsl:call-template>							<xsl:text>Relieur</xsl:text>						</th>						<th>							<xsl:call-template name="sort">								<xsl:with-param name="var">DEPENDENCIES/DEPENDENCY[@type='BookToPrinter']/CONTACT</xsl:with-param>							</xsl:call-template>							<xsl:text>Imprimeur</xsl:text>						</th>						<th>							<xsl:call-template name="sort">								<xsl:with-param name="var">DEPENDENCIES/DEPENDENCY[@type='BookToPeopleContact']/CONTACT</xsl:with-param>							</xsl:call-template>							<xsl:text>Personne de contact</xsl:text>						</th>					</tr>					<xsl:for-each select="$data">						<!--xsl:sort select="$sort" order="descending"/-->						<xsl:apply-templates select="." mode="data"/>					</xsl:for-each>				</table>			</body>		</html>	</xsl:template>	<xsl:template name="sort">		<xsl:param name="var"/>		<a href="{//NECTIL/this_script}?sort={$var}&amp;order=descending">			<img src="images/down.gif"/>		</a>		<a href="{//NECTIL/this_script}?sort={$var}&amp;order=ascending">			<img src="images/up.gif"/>		</a>	</xsl:template>	<xsl:template match="MEDIA" mode="data">		<tr>			<td>				<xsl:value-of select="DESCRIPTIONS/DESCRIPTION/CUSTOM/NUMBER"/>			</td>			<td>				<xsl:value-of select="DESCRIPTIONS/DESCRIPTION/TITLE"/>			</td>			<td>				<xsl:value-of select="DESCRIPTIONS/DESCRIPTION/CUSTOM/YEAR"/>			</td>			<td>				<xsl:choose>					<xsl:when test="DESCRIPTIONS/DESCRIPTION/CUSTOM/REFUS != ''">						<strong>REFUS: </strong>						<xsl:value-of select="DESCRIPTIONS/DESCRIPTION/CUSTOM/REFUS"/>					</xsl:when>					<xsl:otherwise>						<xsl:for-each select="CATEGORIES/CATEGORY[@fatherID = 6]">							<xsl:value-of select="LABEL"/>							<xsl:call-template name="add_coma_if_not_last"/>						</xsl:for-each>					</xsl:otherwise>				</xsl:choose>			</td>			<td>				<xsl:for-each select="CATEGORIES/CATEGORY[@fatherID = 21]">					<xsl:value-of select="LABEL"/>					<xsl:call-template name="add_coma_if_not_last"/>				</xsl:for-each>			</td>			<td>				<xsl:call-template name="display_contact_dependency">					<xsl:with-param name="dependency">BookToEditor</xsl:with-param>				</xsl:call-template>			</td>			<td>				<xsl:call-template name="display_contact_dependency">					<xsl:with-param name="dependency">BookToGraphist</xsl:with-param>				</xsl:call-template>			</td>			<td>				<xsl:call-template name="display_contact_dependency">					<xsl:with-param name="dependency">BookToBinder</xsl:with-param>				</xsl:call-template>			</td>			<td>				<xsl:call-template name="display_contact_dependency">					<xsl:with-param name="dependency">BookToPrinter</xsl:with-param>				</xsl:call-template>			</td>			<td>				<xsl:call-template name="display_contact_dependency">					<xsl:with-param name="dependency">BookToPeopleContact</xsl:with-param>				</xsl:call-template>			</td>		</tr>	</xsl:template>	<xsl:template name="display_contact_dependency">		<xsl:param name="dependency"/>		<xsl:for-each select="DEPENDENCIES/DEPENDENCY[@type = $dependency]/CONTACT">			<xsl:apply-templates select="." mode="title"/>			<xsl:call-template name="add_coma_if_not_last"/>		</xsl:for-each>	</xsl:template>	<xsl:template match="CONTACT" mode="title">		<xsl:value-of select="INFO/TITLE"/>		<xsl:text> </xsl:text>		<xsl:value-of select="INFO/FIRSTNAME"/>		<xsl:text> </xsl:text>		<xsl:value-of select="INFO/LASTNAME"/>	</xsl:template>	<xsl:template match="CONTACT[INFO/TYPE='PM']" mode="title">		<xsl:value-of select="INFO/DENOMINATION"/>	</xsl:template>	<xsl:template name="add_coma_if_not_last">		<xsl:if test="position() != last()">			<xsl:text>, </xsl:text>		</xsl:if>	</xsl:template></xsl:stylesheet>